# 회원가입 시 받는 정보 및 생성되는 정보 정리

## 1. 일반 회원 (SNS 가입)

### 📥 회원가입 시 받는 정보

#### **1단계: SNS 제공자로부터 자동 수집**
- **SNS 제공자** (naver, kakao, google)
- **이메일** (email) - SNS 계정의 이메일
- **이름** (name) - SNS 계정의 이름/닉네임
- **SNS ID** (sns_id) - SNS 제공자의 고유 ID

#### **2단계: 추가 정보 입력 (필수)** ⭐
SNS 로그인 성공 후 전화번호가 없으면 추가 정보 입력 페이지로 자동 이동합니다.
- **이름** (name) - 필수, SNS에서 받은 정보가 기본값으로 채워짐
- **이메일** (email) - 필수, SNS에서 받은 정보가 기본값으로 채워짐
- **휴대폰 번호** (phone) - 필수, 010-XXXX-XXXX 형식

### ✅ 가입 시 자동 생성되는 정보
- **user_id**: 자동 생성 (형식: `{provider_prefix}_{7자리숫자}`)
  - 네이버: `nvr_1234567`
  - 카카오: `kko_2345678`
  - 구글: `gol_3456789`
- **role**: `'user'` (고정값)
- **sns_provider**: SNS 제공자명 (naver, kakao, google)
- **created_at**: 가입 시각 (형식: `YYYY-MM-DD HH:MM:SS`)
- **seller_approved**: `false` (고정값)

### 📝 저장되는 최종 데이터 구조
```json
{
  "user_id": "nvr_1234567",
  "email": "user@example.com",
  "name": "홍길동",
  "phone": "010-1234-5678",
  "role": "user",
  "sns_provider": "naver",
  "sns_id": "sns_000001",
  "created_at": "2025-01-01 10:00:00",
  "seller_approved": false
}
```

### 📍 저장 위치
- 파일: `includes/data/users.json`

---

## 2. 판매자 (직접 가입)

### 📥 회원가입 시 받는 정보 (사용자 입력)

#### **1단계: 기본 정보**
- **아이디** (user_id) - 필수, 소문자 영문+숫자 5-20자
- **비밀번호** (password) - 필수, 최소 8자
- **비밀번호 확인** (password_confirm) - 필수
- **이메일** (email) - 필수
  - 이메일 아이디 (email_local) - 최대 20자
  - 이메일 도메인 선택 또는 직접 입력 (email_domain / email_custom)
- **이름** (name) - 필수

#### **2단계: 서류 업로드**
- **사업자등록증 이미지** (business_license_image) - 필수
  - JPG, PNG만 가능 (GIF, PDF 등 문서 파일 불가)
  - 최대 5MB

#### **3단계: 판매 상품 선택** ⭐ (최근 추가된 단계)
- **판매 상품 권한** (permissions[]) - 필수, 복수 선택 가능
  - `mno` (통신사폰)
  - `mvno` (알뜰폰)
  - `internet` (인터넷)
  - 최소 1개 이상 선택

#### **4단계: 사업자 정보**
- **전화번호** (phone) - 선택 (쉼표로 여러 개 입력 가능)
- **휴대폰** (mobile) - 필수, 010으로 시작하는 11자리
- **우편번호** (postal_code) - 선택
- **주소** (address) - 필수
- **상세주소** (address_detail) - 선택
- **사업자등록번호** (business_number) - 필수
- **회사명** (company_name) - 필수, 최대 20자
- **대표자명** (company_representative) - 필수, 최대 20자
- **업종** (business_type) - 필수, 최대 20자
- **업태** (business_item) - 필수, 최대 20자

### ✅ 가입 시 자동 생성되는 정보
- **password**: 비밀번호 해시 (password_hash 사용)
- **role**: `'seller'` (고정값)
- **created_at**: 가입 시각 (형식: `YYYY-MM-DD HH:MM:SS`)
- **seller_approved**: `false` (초기값, 관리자 승인 필요)
- **approval_status**: `'pending'` (승인 대기 상태)
- **permissions**: 선택한 판매 상품 권한 배열 (초기값: 빈 배열, 사용자가 선택한 값으로 설정)

### 📝 저장되는 최종 데이터 구조
```json
{
  "user_id": "seller123",
  "email": "seller@example.com",
  "name": "홍길동",
  "password": "$2y$10$...",
  "role": "seller",
  "phone": "02-1234-5678",
  "mobile": "010-1234-5678",
  "postal_code": "12345",
  "address": "서울시 강남구",
  "address_detail": "123번지",
  "business_number": "123-45-67890",
  "company_name": "(주)회사명",
  "company_representative": "홍길동",
  "business_type": "도매 및 소매업",
  "business_item": "통신판매업",
  "business_license_image": "/MVNO/uploads/sellers/seller123_license_1234567890.jpg",
  "permissions": ["mno", "mvno", "internet"],
  "created_at": "2025-01-01 10:00:00",
  "seller_approved": false,
  "approval_status": "pending"
}
```

### 📍 저장 위치
- 파일: `includes/data/sellers.json`

---

## 3. 관리자/부관리자 (직접 가입)

### 📥 회원가입 시 받는 정보 (사용자 입력)
- **아이디** (user_id) - 필수
- **비밀번호** (password) - 필수, 최소 8자
- **비밀번호 확인** (password_confirm) - 필수
- **이메일** (email) - 필수
- **이름** (name) - 필수
- **휴대폰** (phone) - 필수, 010-XXXX-XXXX 형식
- **회원 유형** (role) - admin 또는 sub_admin

### ✅ 가입 시 자동 생성되는 정보
- **password**: 비밀번호 해시 (password_hash 사용)
- **role**: `'admin'` 또는 `'sub_admin'` (선택한 값)
- **created_at**: 가입 시각 (형식: `YYYY-MM-DD HH:MM:SS`)
- **seller_approved**: `true` (관리자는 자동 승인)

### 📝 저장되는 최종 데이터 구조
```json
{
  "user_id": "admin123",
  "email": "admin@example.com",
  "name": "관리자",
  "password": "$2y$10$...",
  "role": "admin",
  "phone": "010-1234-5678",
  "created_at": "2025-01-01 10:00:00",
  "seller_approved": true
}
```

### 📍 저장 위치
- 파일: `includes/data/admins.json`

---

## 요약

### 📊 회원 유형별 비교

| 항목 | 일반 회원 (SNS) | 판매자 | 관리자/부관리자 |
|------|----------------|--------|----------------|
| **가입 방법** | SNS 로그인 | 직접 가입 | 직접 가입 |
| **필수 입력 정보** | 이름, 이메일, 전화번호 (SNS 후 추가 입력) | 아이디, 비밀번호, 이메일, 이름, 휴대폰, 주소, 사업자정보, 서류 | 아이디, 비밀번호, 이메일, 이름, 휴대폰 |
| **자동 생성 정보** | user_id, created_at | user_id, password 해시, created_at, approval_status | user_id, password 해시, created_at |
| **승인 필요 여부** | 없음 | 있음 (관리자 승인) | 없음 (자동 승인) |
| **저장 파일** | users.json | sellers.json | admins.json |

### 🔑 주요 생성 정보 설명

1. **user_id (일반 회원)**
   - SNS 제공자와 SNS ID를 조합하여 해시로 생성
   - 형식: `{provider_prefix}_{7자리숫자}`
   - 중복 시 자동 재생성

2. **user_id (판매자/관리자)**
   - 사용자가 직접 입력
   - 중복 체크 후 사용

3. **created_at**
   - 모든 회원 타입에 동일하게 생성
   - 한국 시간대 (Asia/Seoul) 기준
   - 형식: `YYYY-MM-DD HH:MM:SS`

4. **password**
   - 직접 가입하는 회원만 생성
   - PHP `password_hash()` 함수로 해시화
   - SNS 가입 회원은 비밀번호 없음

5. **permissions (판매자만)**
   - 판매자가 선택한 상품 권한
   - `['mno', 'mvno', 'internet']` 중 선택
   - 관리자가 나중에 수정 가능

### 📝 참고사항

- **일반 회원**은 SNS 로그인 후 전화번호가 없으면 추가 정보 입력 페이지(`/MVNO/auth/complete-profile.php`)로 자동 이동됩니다. 이름, 이메일, 전화번호를 필수로 입력해야 합니다.
- **판매자**는 승인 전까지 상품 등록 불가 (seller_approved: false)
- **관리자/부관리자**는 가입 즉시 모든 권한 사용 가능
- 모든 데이터는 JSON 파일로 저장되며, 역할별로 파일 분리되어 관리됨
- 일반 회원의 전화번호는 010으로 시작하는 11자리 형식으로 저장됩니다 (예: 010-1234-5678)

